(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var n=function(){var n,o;function r(e,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),t(this,"_title",void 0),t(this,"_description",void 0),t(this,"_duedate",void 0),t(this,"_priority",void 0),t(this,"_notes",void 0),t(this,"_checklist",void 0),t(this,"_id",void 0),this._id=r.id,r.id++,this._title=e,this._description=n,this._priority=o}return n=r,(o=[{key:"title",get:function(){return this._title},set:function(e){this._title=e}},{key:"description",get:function(){return this._description},set:function(e){this._description=e}},{key:"duedate",get:function(){return this._duedate},set:function(e){this._duedate=e}},{key:"priority",get:function(){return this._priority},set:function(e){this._priority=e}},{key:"notes",get:function(){return this._notes},set:function(e){this._notes=e}},{key:"checklist",get:function(){return this._checklist},set:function(e){this._checklist=e}},{key:"id",get:function(){return this._id}}])&&e(n.prototype,o),r}();function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t(n,"id",1);var a=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"_todoList",[]),i(this,"_id",void 0),i(this,"_name",void 0),i(this,"addTodo",(function(e){n._todoList.push(e)})),this._id=e.id,e.id++,this._name=t}return r(e,[{key:"todoList",get:function(){return this._todoList}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}}]),r(e,[{key:"deleteTodo",value:function(e){for(var t=[],n=0;n<this._todoList.length;n++)!this._todoList[n].id===e&&t.push(this._todoList[n]);this._todoList=[].concat(t)}}]),e}();function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}i(a,"id",1);var s=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d(this,"_projectList",[]),d(this,"addProject",(function(e){t._projectList.push(e)})),d(this,"updateProjectName",(function(e,n){t._projectList.forEach((function(t){t.id===n&&(t.name=e)}))})),d(this,"removeProject",(function(e){t._projectList=t._projectList.filter((function(t){return t.id!==e}))}))}var t,n;return t=e,(n=[{key:"getProject",value:function(e){return this._projectList.find((function(t){return t.id===e}))}},{key:"projectList",get:function(){return this._projectList}}])&&c(t.prototype,n),e}(),l=function(){var e=document.getElementById("project-wrapper"),t=document.getElementById("project-form"),n=document.getElementById("project-name"),o=(document.getElementById("get-project-name"),document.getElementById("sidenav"));function r(t){var n=e.querySelectorAll("li");return Array.from(n).find((function(e){return e.id==="project-".concat(t)}))}return{createProjectUI:function(t,n){var r=document.createElement("li");r.id="project-".concat(n);var i=document.createElement("div");i.id="project-row",i.classList.add("project-row"),o.classList.contains("show-sidenav")||i.classList.add("project-row-whitespace");var a=document.createElement("div");a.classList.add("project-header");var c=document.createElement("img");c.classList.add("toggle-task-btn"),c.src="./images/icons8-expand-arrow-16.png";var d=document.createElement("button");d.dataset.id="project-name",d.textContent=t;var s=document.createElement("button");s.textContent="-",s.classList.add("remove-project"),s.dataset.id="remove-project",a.appendChild(c),a.appendChild(d),a.appendChild(s);var l=document.createElement("div");l.dataset.id="task-wrapper",l.classList.add("task-wrapper"),l.classList.add("task-wrapper-off"),i.appendChild(a),i.appendChild(l),r.appendChild(i),e.appendChild(r)},addProjectForm:t,inputElement:n,closeProjectInputName:function(){t.reset(),document.getElementById("get-project-name").classList.toggle("get-project-name-off")},removeProject:function(t){e.querySelectorAll("li").forEach((function(e){e.id==="project-".concat(t)&&e.remove()}))},projectWrapper:e,getProject:r,removeProjectFromTaskForm:function(e){document.getElementById("project-".concat(e)).remove()},addProjectToTaskForm:function(e,t){var n=document.getElementById("todo-form-projects"),o=document.createElement("option");o.value=e,o.id="project-".concat(e),o.textContent=t,n.appendChild(o)},getTaskWrapper:function(e){return r(e).querySelector('div[data-id="task-wrapper"]')}}}();function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"HIGH",get:function(){return{color:"#e53935",value:0,text:"high"}}},{key:"MEDIUM",get:function(){return{color:"#FFB300",value:1,text:"medium"}}},{key:"LOW",get:function(){return{color:"#43A047",value:2,text:"low"}}}],null&&u(t.prototype,null),n&&u(t,n),e}();function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f,v,h,g,y,j,k,E,b,L,_=(v=document.getElementsByClassName("content")[0],h=document.getElementById("todo-form"),g=document.getElementById("submit-todo"),y=document.getElementsByName("priority"),j=document.getElementById("todo-title"),k=document.getElementById("todo-description"),E=document.getElementById("todo-form-projects"),m(f={createTaskNavBar:function(e,t,n){var o=document.createElement("div");o.classList.add("task"),o.id="navTask-".concat(e);var r=document.createElement("div");switch(r.classList.add("priority-icon"),n){case p.LOW.text:r.style.backgroundColor=p.LOW.color;break;case p.MEDIUM.text:r.style.backgroundColor=p.MEDIUM.color;break;case p.HIGH.text:r.style.backgroundColor=p.HIGH.color}var i=document.createElement("div");return i.classList.add("task-name"),i.textContent=t,o.appendChild(r),o.appendChild(i),o},createTask:b=function(e,t,n,o,r){var i=document.createElement("div");i.classList.add("card"),i.id="card-".concat(e),i.dataset.project=t;var a=document.createElement("div");switch(a.classList.add("card-header"),r){case p.LOW.text:a.style.backgroundColor=p.LOW.color;break;case p.MEDIUM.text:a.style.backgroundColor=p.MEDIUM.color;break;case p.HIGH.text:a.style.backgroundColor=p.HIGH.color}var c=document.createElement("h4");c.textContent=n;var d=document.createElement("button");d.classList.add("button2"),d.textContent="-",a.appendChild(c),a.appendChild(d);var s=document.createElement("textarea");s.classList.add("card-body"),s.value=o,i.appendChild(a),i.appendChild(s),v.appendChild(i)},formPriorityElements:y,addTodoForm:h,todoSubmitBtn:g,formDescriptionElement:k,formTitleElement:j,formProjectElement:E,closeTaskInputForm:function(){h.reset(),document.getElementById("add-todo-modal").classList.toggle("add-todo-modal-off")}},"createTask",b),m(f,"getTasksByProjectId",(function(e){return document.querySelectorAll('div[data-project="'.concat(e,'"]'))})),m(f,"content",v),m(f,"getNavTaskById",(function(e){return document.getElementById("navTask-".concat(e))})),f),I=new s;(L=new a("default"))._id=0,I.addProject(L),l.createProjectUI(L.name,L.id),document.getElementById("project-0").querySelector(".project-row").classList.remove("project-row-whitespace"),l.addProjectForm.addEventListener("submit",(function(e){e.preventDefault();var t=l.inputElement.value,n=function(e){var t=new a(e);return I.addProject(t),l.createProjectUI(t.name,t.id),t.id}(t);l.closeProjectInputName(),l.addProjectToTaskForm(n,t)})),l.projectWrapper.addEventListener("click",(function(e){if("remove-project"===e.target.dataset.id){var t=e.target.parentNode.parentNode.parentNode.id.split("-")[1];!function(e){0!==e&&(console.log(I.projectList),I.removeProject(e),l.removeProject(e),l.removeProjectFromTaskForm(e),_.getTasksByProjectId(e).forEach((function(e){e.remove()})),console.log(I.projectList))}(parseInt(t))}})),_.content.addEventListener("click",(function(e){if(e.target.classList.contains("button2")){var t=e.target.parentNode.parentNode,n=t.id,o=parseInt(t.dataset.project),r=parseInt(n.split("-")[1]);t.remove(),_.getNavTaskById(r).remove();var i=I.getProject(o);console.log(i._todoList),i.deleteTodo(r),console.log(i._todoList)}})),_.content.addEventListener("change",(function(e){if(e.target.classList.contains("card-body")){var t=e.target,n=e.target.parentNode,o=n.id,r=parseInt(o.split("-")[1]),i=parseInt(n.dataset.project);I.getProject(i).todoList.find((function(e){return e.id===r})).description=t.value,console.log(I.getProject(i).todoList)}})),_.addTodoForm.addEventListener("submit",(function(e){var t,o;e.preventDefault(),function(e,t,o,r){var i=new n(t,o,r,e);console.table(I.projectList);for(var a=I.projectList,c=0;c<a.length;c++)if(a[c].id===e){a[c].addTodo(i);break}var d=_.createTaskNavBar(i.id,i.title,i.priority);l.getTaskWrapper(e).appendChild(d),_.createTask(i.id,e,i.title,i.description,i.priority)}((o=_.formProjectElement,parseInt(o.value)),_.formTitleElement.value,_.formDescriptionElement.value,(_.formPriorityElements.forEach((function(e){e.checked&&(t=e.value)})),t)),_.closeTaskInputForm()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvLy4vc3JjL1RvZG8uanMiLCJ3ZWJwYWNrOi8vdG9kby8uL3NyYy9Qcm9qZWN0LmpzIiwid2VicGFjazovL3RvZG8vLi9zcmMvTWFpbkFwcC5qcyIsIndlYnBhY2s6Ly90b2RvLy4vc3JjL3Byb2plY3RVSS5qcyIsIndlYnBhY2s6Ly90b2RvLy4vc3JjL3ByaW9yaXR5RW51bS5qcyIsIndlYnBhY2s6Ly90b2RvLy4vc3JjL3Rhc2tVSS5qcyIsIndlYnBhY2s6Ly90b2RvLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbIlRvZG8iLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicHJpb3JpdHkiLCJ0aGlzIiwiX2lkIiwiaWQiLCJfdGl0bGUiLCJfZGVzY3JpcHRpb24iLCJfcHJpb3JpdHkiLCJ2YWx1ZSIsIl9kdWVkYXRlIiwiX25vdGVzIiwiX2NoZWNrbGlzdCIsIlByb2plY3QiLCJuYW1lIiwidG9kbyIsIl90b2RvTGlzdCIsInB1c2giLCJfbmFtZSIsIm5ld0FycmF5IiwiaSIsImxlbmd0aCIsIk1haW5BcHAiLCJwcm9qZWN0IiwiX3Byb2plY3RMaXN0IiwiZm9yRWFjaCIsImZpbHRlciIsImZpbmQiLCJwcm9qZWN0VUkiLCJwcm9qZWN0V3JhcHBlciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJhZGRQcm9qZWN0Rm9ybSIsImlucHV0RWxlbWVudCIsInNpZGVuYXYiLCJnZXRQcm9qZWN0IiwibGlFbGVtZW50cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJBcnJheSIsImZyb20iLCJsaUVsZW1lbnQiLCJjcmVhdGVQcm9qZWN0VUkiLCJsaSIsImNyZWF0ZUVsZW1lbnQiLCJwcm9qZWN0Um93IiwiY2xhc3NMaXN0IiwiYWRkIiwiY29udGFpbnMiLCJwcm9qZWN0SGVhZGVyIiwidG9nZ2xlVGFza0J0biIsInNyYyIsInByb2plY3ROYW1lIiwiZGF0YXNldCIsInRleHRDb250ZW50IiwicmVtb3ZlUHJvamVjdEJ0biIsImFwcGVuZENoaWxkIiwidGFza1dyYXBwZXIiLCJjbG9zZVByb2plY3RJbnB1dE5hbWUiLCJyZXNldCIsInRvZ2dsZSIsInJlbW92ZVByb2plY3QiLCJyZW1vdmUiLCJyZW1vdmVQcm9qZWN0RnJvbVRhc2tGb3JtIiwiYWRkUHJvamVjdFRvVGFza0Zvcm0iLCJ0b2RvRm9ybVByb2plY3QiLCJvcHRpb24iLCJnZXRUYXNrV3JhcHBlciIsInF1ZXJ5U2VsZWN0b3IiLCJjb2xvciIsInRleHQiLCJjb250ZW50IiwiYWRkVG9kb0Zvcm0iLCJ0b2RvU3VibWl0QnRuIiwiZm9ybVByaW9yaXR5RWxlbWVudHMiLCJmb3JtVGl0bGVFbGVtZW50IiwiZm9ybURlc2NyaXB0aW9uRWxlbWVudCIsImZvcm1Qcm9qZWN0RWxlbWVudCIsImNyZWF0ZVRhc2siLCJkZWZhdWx0UHJvamVjdCIsInRhc2tVSSIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJnZXRFbGVtZW50c0J5TmFtZSIsImNyZWF0ZVRhc2tOYXZCYXIiLCJwcmlvcml0eUluIiwidGFza0VsZW1lbnQiLCJwcmlvcml0eUljb24iLCJMT1ciLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsIk1FRElVTSIsIkhJR0giLCJ0YXNrTmFtZSIsInByb2plY3RJZCIsImNhcmQiLCJjYXJkSGVhZGVyIiwiaDQiLCJkZWxldGVUYXNrQnRuIiwiY2FyZEJvZHkiLCJjbG9zZVRhc2tJbnB1dEZvcm0iLCJtcCIsImFkZFByb2plY3QiLCJlIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJwYXJlbnROb2RlIiwic3BsaXQiLCJjb25zb2xlIiwibG9nIiwicHJvamVjdExpc3QiLCJnZXRUYXNrc0J5UHJvamVjdElkIiwiZWxlbWVudCIsImRlbGV0ZVByb2plY3QiLCJwYXJzZUludCIsImNhcmRJZCIsInRhc2tJZCIsInByb2plY3RPZlRhc2siLCJkZWxldGVUb2RvIiwidG9kb0xpc3QiLCJjaGVja2VkVmFsdWUiLCJ0YXNrRGVzY3IiLCJ0YXNrUHJpbyIsInRhc2siLCJ0YWJsZSIsImFy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QUFXQyxHQUMvQyxJQUFJQyxFQUFPLElBQUkxSCxFQUFLNEYsRUFBVTRCLEVBQVdDLEVBQVU1QixHQUNuRGMsUUFBUWdCLE1BQU12QixFQUFHUyxhQUVqQixJQURBLElBQUllLEVBQVF4QixFQUFHUyxZQUNOeEYsRUFBSSxFQUFHQSxFQUFJdUcsRUFBTXRHLE9BQVFELElBQ2hDLEdBQUl1RyxFQUFNdkcsR0FBR2YsS0FBT3VGLEVBQVcsQ0FDN0IrQixFQUFNdkcsR0FBR3dHLFFBQVFILEdBQ2pCLE1BSUosSUFBTUksRUFBb0I5QyxFQUFPRyxpQkFDL0J1QyxFQUFLcEgsR0FDTG9ILEVBQUt6SCxNQUNMeUgsRUFBS3ZILFVBRWEwQixFQUFVc0MsZUFBZTBCLEdBQ2pDckMsWUFBWXNFLEdBQ3hCOUMsYUFDRTBDLEVBQUtwSCxHQUNMdUYsRUFDQTZCLEVBQUt6SCxNQUNMeUgsRUFBS3hILFlBQ0x3SCxFQUFLdkgsVUEyRFA0SCxFQXRDSWhCLEVBQVUvQixFQUFPSCxtQkFDZG9DLFNBQVNGLEVBQVFyRyxRQWpCakJzRSxFQUFPTCxpQkFBaUJqRSxNQUd4QnNFLEVBQU9KLHVCQUF1QmxFLE9BR3RCc0UsRUFBT04scUJBRWJoRCxTQUFRLFNBQUNxRixHQUNaQSxFQUFRaUIsVUFDVlQsRUFBZVIsRUFBUXJHLFVBR3BCNkcsSUEwQ1B2QywyQiIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgVG9kbyB7XG4gIF90aXRsZTtcbiAgZ2V0IHRpdGxlKCkge1xuICAgIHJldHVybiB0aGlzLl90aXRsZTtcbiAgfVxuICBzZXQgdGl0bGUodmFsdWUpIHtcbiAgICB0aGlzLl90aXRsZSA9IHZhbHVlO1xuICB9XG4gIF9kZXNjcmlwdGlvbjtcbiAgZ2V0IGRlc2NyaXB0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLl9kZXNjcmlwdGlvbjtcbiAgfVxuICBzZXQgZGVzY3JpcHRpb24odmFsdWUpIHtcbiAgICB0aGlzLl9kZXNjcmlwdGlvbiA9IHZhbHVlO1xuICB9XG4gIF9kdWVkYXRlO1xuICBnZXQgZHVlZGF0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fZHVlZGF0ZTtcbiAgfVxuICBzZXQgZHVlZGF0ZSh2YWx1ZSkge1xuICAgIHRoaXMuX2R1ZWRhdGUgPSB2YWx1ZTtcbiAgfVxuICBfcHJpb3JpdHk7XG4gIGdldCBwcmlvcml0eSgpIHtcbiAgICByZXR1cm4gdGhpcy5fcHJpb3JpdHk7XG4gIH1cbiAgc2V0IHByaW9yaXR5KHZhbHVlKSB7XG4gICAgdGhpcy5fcHJpb3JpdHkgPSB2YWx1ZTtcbiAgfVxuICBfbm90ZXM7XG4gIGdldCBub3RlcygpIHtcbiAgICByZXR1cm4gdGhpcy5fbm90ZXM7XG4gIH1cbiAgc2V0IG5vdGVzKHZhbHVlKSB7XG4gICAgdGhpcy5fbm90ZXMgPSB2YWx1ZTtcbiAgfVxuICBfY2hlY2tsaXN0O1xuICBnZXQgY2hlY2tsaXN0KCkge1xuICAgIHJldHVybiB0aGlzLl9jaGVja2xpc3Q7XG4gIH1cbiAgc2V0IGNoZWNrbGlzdCh2YWx1ZSkge1xuICAgIHRoaXMuX2NoZWNrbGlzdCA9IHZhbHVlO1xuICB9XG4gIHN0YXRpYyBpZCA9IDE7XG4gIF9pZDtcbiAgZ2V0IGlkKCkge1xuICAgIHJldHVybiB0aGlzLl9pZDtcbiAgfVxuICBjb25zdHJ1Y3Rvcih0aXRsZSwgZGVzY3JpcHRpb24sIHByaW9yaXR5KSB7XG4gICAgdGhpcy5faWQgPSBUb2RvLmlkO1xuICAgIFRvZG8uaWQrKztcbiAgICB0aGlzLl90aXRsZSA9IHRpdGxlO1xuICAgIHRoaXMuX2Rlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgdGhpcy5fcHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgfVxufVxuXG5leHBvcnQgeyBUb2RvIH07XG4iLCJjbGFzcyBQcm9qZWN0IHtcbiAgc3RhdGljIGlkID0gMTtcbiAgX3RvZG9MaXN0ID0gW107XG4gIGdldCB0b2RvTGlzdCgpIHtcbiAgICByZXR1cm4gdGhpcy5fdG9kb0xpc3Q7XG4gIH1cbiAgX2lkO1xuICBnZXQgaWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lkO1xuICB9XG4gIF9uYW1lO1xuICBnZXQgbmFtZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fbmFtZTtcbiAgfVxuICBzZXQgbmFtZSh2YWx1ZSkge1xuICAgIHRoaXMuX25hbWUgPSB2YWx1ZTtcbiAgfVxuICBjb25zdHJ1Y3RvcihuYW1lKSB7XG4gICAgdGhpcy5faWQgPSBQcm9qZWN0LmlkO1xuICAgIFByb2plY3QuaWQrKztcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgfVxuXG4gIGFkZFRvZG8gPSAodG9kbykgPT4ge1xuICAgIHRoaXMuX3RvZG9MaXN0LnB1c2godG9kbyk7XG4gIH07XG5cbiAgZGVsZXRlVG9kbyhpZCkge1xuICAgIGxldCBuZXdBcnJheSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5fdG9kb0xpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghdGhpcy5fdG9kb0xpc3RbaV0uaWQgPT09IGlkKSB7XG4gICAgICAgIG5ld0FycmF5LnB1c2godGhpcy5fdG9kb0xpc3RbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLl90b2RvTGlzdCA9IFsuLi5uZXdBcnJheV07XG4gIH1cbn1cblxuZXhwb3J0IHsgUHJvamVjdCB9O1xuIiwiY2xhc3MgTWFpbkFwcCB7XG4gIF9wcm9qZWN0TGlzdCA9IFtdO1xuXG4gIGFkZFByb2plY3QgPSAocHJvamVjdCkgPT4ge1xuICAgIHRoaXMuX3Byb2plY3RMaXN0LnB1c2gocHJvamVjdCk7XG4gIH07XG5cbiAgZ2V0UHJvamVjdChpZCkge1xuICAgIHJldHVybiB0aGlzLl9wcm9qZWN0TGlzdC5maW5kKChwcm9qZWN0KSA9PiBwcm9qZWN0LmlkID09PSBpZCk7XG4gIH1cblxuICB1cGRhdGVQcm9qZWN0TmFtZSA9IChuYW1lLCBpZCkgPT4ge1xuICAgIHRoaXMuX3Byb2plY3RMaXN0LmZvckVhY2goKHByb2plY3QpID0+IHtcbiAgICAgIGlmIChwcm9qZWN0LmlkID09PSBpZCkge1xuICAgICAgICBwcm9qZWN0Lm5hbWUgPSBuYW1lO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIHJlbW92ZVByb2plY3QgPSAoaWQpID0+IHtcbiAgICB0aGlzLl9wcm9qZWN0TGlzdCA9IHRoaXMuX3Byb2plY3RMaXN0LmZpbHRlcihcbiAgICAgIChwcm9qZWN0KSA9PiBwcm9qZWN0LmlkICE9PSBpZFxuICAgICk7XG4gIH07XG5cbiAgZ2V0IHByb2plY3RMaXN0KCkge1xuICAgIHJldHVybiB0aGlzLl9wcm9qZWN0TGlzdDtcbiAgfVxufVxuXG5leHBvcnQgeyBNYWluQXBwIH07XG4iLCJjb25zdCBwcm9qZWN0VUkgPSAoKCkgPT4ge1xuICBjb25zdCBwcm9qZWN0V3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvamVjdC13cmFwcGVyXCIpO1xuICBjb25zdCBhZGRQcm9qZWN0Rm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvamVjdC1mb3JtXCIpO1xuICBjb25zdCBpbnB1dEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2plY3QtbmFtZVwiKTtcbiAgY29uc3QgZ2V0UHJvamVjdE5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdldC1wcm9qZWN0LW5hbWVcIik7XG4gIGNvbnN0IHNpZGVuYXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNpZGVuYXZcIik7XG5cbiAgZnVuY3Rpb24gY2xvc2VQcm9qZWN0SW5wdXROYW1lKCkge1xuICAgIGFkZFByb2plY3RGb3JtLnJlc2V0KCk7XG4gICAgY29uc3QgZ2V0UHJvamVjdE5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdldC1wcm9qZWN0LW5hbWVcIik7XG4gICAgZ2V0UHJvamVjdE5hbWUuY2xhc3NMaXN0LnRvZ2dsZShcImdldC1wcm9qZWN0LW5hbWUtb2ZmXCIpO1xuICB9XG4gIGZ1bmN0aW9uIGdldFByb2plY3QoaWQpIHtcbiAgICBjb25zdCBsaUVsZW1lbnRzID0gcHJvamVjdFdyYXBwZXIucXVlcnlTZWxlY3RvckFsbChcImxpXCIpO1xuICAgIGxldCBmb3VuZEVsZW1lbnQ7XG4gICAgcmV0dXJuIEFycmF5LmZyb20obGlFbGVtZW50cykuZmluZChcbiAgICAgIChsaUVsZW1lbnQpID0+IGxpRWxlbWVudC5pZCA9PT0gYHByb2plY3QtJHtpZH1gXG4gICAgKTtcbiAgfVxuICBmdW5jdGlvbiBnZXRUYXNrV3JhcHBlcihpZCkge1xuICAgIGNvbnN0IGxpRWxlbWVudCA9IGdldFByb2plY3QoaWQpO1xuICAgIHJldHVybiBsaUVsZW1lbnQucXVlcnlTZWxlY3RvcignZGl2W2RhdGEtaWQ9XCJ0YXNrLXdyYXBwZXJcIl0nKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZVByb2plY3QoaWQpIHtcbiAgICBjb25zdCBsaUVsZW1lbnRzID0gcHJvamVjdFdyYXBwZXIucXVlcnlTZWxlY3RvckFsbChcImxpXCIpO1xuICAgIGxpRWxlbWVudHMuZm9yRWFjaCgobGlFbGVtZW50KSA9PiB7XG4gICAgICBpZiAobGlFbGVtZW50LmlkID09PSBgcHJvamVjdC0ke2lkfWApIHtcbiAgICAgICAgbGlFbGVtZW50LnJlbW92ZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIGZ1bmN0aW9uIGNyZWF0ZVByb2plY3RVSShuYW1lLCBpZCkge1xuICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpO1xuICAgIGxpLmlkID0gYHByb2plY3QtJHtpZH1gO1xuICAgIHtcbiAgICAgIGNvbnN0IHByb2plY3RSb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgcHJvamVjdFJvdy5pZCA9IFwicHJvamVjdC1yb3dcIjtcbiAgICAgIHByb2plY3RSb3cuY2xhc3NMaXN0LmFkZChcInByb2plY3Qtcm93XCIpO1xuICAgICAgaWYgKCFzaWRlbmF2LmNsYXNzTGlzdC5jb250YWlucyhcInNob3ctc2lkZW5hdlwiKSkge1xuICAgICAgICBwcm9qZWN0Um93LmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LXJvdy13aGl0ZXNwYWNlXCIpO1xuICAgICAgfVxuICAgICAge1xuICAgICAgICBjb25zdCBwcm9qZWN0SGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgcHJvamVjdEhlYWRlci5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC1oZWFkZXJcIik7XG4gICAgICAgIHtcbiAgICAgICAgICBjb25zdCB0b2dnbGVUYXNrQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcbiAgICAgICAgICB0b2dnbGVUYXNrQnRuLmNsYXNzTGlzdC5hZGQoXCJ0b2dnbGUtdGFzay1idG5cIik7XG4gICAgICAgICAgdG9nZ2xlVGFza0J0bi5zcmMgPSBcIi4vaW1hZ2VzL2ljb25zOC1leHBhbmQtYXJyb3ctMTYucG5nXCI7XG4gICAgICAgICAgY29uc3QgcHJvamVjdE5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgICAgIHByb2plY3ROYW1lLmRhdGFzZXQuaWQgPSBcInByb2plY3QtbmFtZVwiO1xuICAgICAgICAgIHByb2plY3ROYW1lLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICAgICAgICBjb25zdCByZW1vdmVQcm9qZWN0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgICAgICByZW1vdmVQcm9qZWN0QnRuLnRleHRDb250ZW50ID0gXCItXCI7XG4gICAgICAgICAgcmVtb3ZlUHJvamVjdEJ0bi5jbGFzc0xpc3QuYWRkKFwicmVtb3ZlLXByb2plY3RcIik7XG4gICAgICAgICAgcmVtb3ZlUHJvamVjdEJ0bi5kYXRhc2V0LmlkID0gXCJyZW1vdmUtcHJvamVjdFwiO1xuICAgICAgICAgIHByb2plY3RIZWFkZXIuYXBwZW5kQ2hpbGQodG9nZ2xlVGFza0J0bik7XG4gICAgICAgICAgcHJvamVjdEhlYWRlci5hcHBlbmRDaGlsZChwcm9qZWN0TmFtZSk7XG4gICAgICAgICAgcHJvamVjdEhlYWRlci5hcHBlbmRDaGlsZChyZW1vdmVQcm9qZWN0QnRuKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBwcm9qZWN0Um93LmFwcGVuZENoaWxkKHByb2plY3RIZWFkZXIpO1xuICAgICAgICBjb25zdCB0YXNrV3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHRhc2tXcmFwcGVyLmRhdGFzZXQuaWQgPSBcInRhc2std3JhcHBlclwiO1xuICAgICAgICB0YXNrV3JhcHBlci5jbGFzc0xpc3QuYWRkKFwidGFzay13cmFwcGVyXCIpO1xuICAgICAgICB0YXNrV3JhcHBlci5jbGFzc0xpc3QuYWRkKFwidGFzay13cmFwcGVyLW9mZlwiKTtcbiAgICAgICAge1xuICAgICAgICAgIC8vIGNvbnN0IHRhc2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAvLyB0YXNrLmNsYXNzTGlzdC5hZGQoJ3Rhc2snKTtcbiAgICAgICAgICAvLyB7XG4gICAgICAgICAgLy8gXHRjb25zdCBwcmlvcml0eUljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAvLyBcdHByaW9yaXR5SWNvbi5jbGFzc0xpc3QuYWRkKCdwcmlvcml0eS1pY29uJyk7XG4gICAgICAgICAgLy8gXHRjb25zdCB0YXNrTmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgIC8vIFx0dGFza05hbWUuY2xhc3NMaXN0LmFkZCgndGFzay1uYW1lJyk7XG4gICAgICAgICAgLy8gXHR0YXNrTmFtZS50ZXh0Q29udGVudCA9J2RvIHRoZSBhZnBlb3Nmaic7XG4gICAgICAgICAgLy8gfVxuICAgICAgICB9XG4gICAgICAgIHByb2plY3RSb3cuYXBwZW5kQ2hpbGQocHJvamVjdEhlYWRlcik7XG4gICAgICAgIHByb2plY3RSb3cuYXBwZW5kQ2hpbGQodGFza1dyYXBwZXIpO1xuICAgICAgfVxuICAgICAgbGkuYXBwZW5kQ2hpbGQocHJvamVjdFJvdyk7XG4gICAgfVxuICAgIHByb2plY3RXcmFwcGVyLmFwcGVuZENoaWxkKGxpKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZFByb2plY3RUb1Rhc2tGb3JtKGlkLCBuYW1lKSB7XG4gICAgY29uc3QgdG9kb0Zvcm1Qcm9qZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b2RvLWZvcm0tcHJvamVjdHNcIik7XG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcbiAgICBvcHRpb24udmFsdWUgPSBpZDtcbiAgICBvcHRpb24uaWQgPSBgcHJvamVjdC0ke2lkfWA7XG4gICAgb3B0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0b2RvRm9ybVByb2plY3QuYXBwZW5kQ2hpbGQob3B0aW9uKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZVByb2plY3RGcm9tVGFza0Zvcm0oaWQpIHtcbiAgICBjb25zdCBvcHRpb25FbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYHByb2plY3QtJHtpZH1gKTtcbiAgICBvcHRpb25FbGVtZW50LnJlbW92ZSgpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBjcmVhdGVQcm9qZWN0VUksXG4gICAgYWRkUHJvamVjdEZvcm0sXG4gICAgaW5wdXRFbGVtZW50LFxuICAgIGNsb3NlUHJvamVjdElucHV0TmFtZSxcbiAgICByZW1vdmVQcm9qZWN0LFxuICAgIHByb2plY3RXcmFwcGVyLFxuICAgIGdldFByb2plY3QsXG4gICAgcmVtb3ZlUHJvamVjdEZyb21UYXNrRm9ybSxcbiAgICBhZGRQcm9qZWN0VG9UYXNrRm9ybSxcbiAgICBnZXRUYXNrV3JhcHBlcixcbiAgfTtcbn0pKCk7XG5cbmV4cG9ydCB7IHByb2plY3RVSSB9O1xuIiwiY2xhc3MgcHJpb3JpdHkge1xuICBzdGF0aWMgZ2V0IEhJR0goKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGNvbG9yOiBcIiNlNTM5MzVcIiwgLy9yZWRpc2hcbiAgICAgIHZhbHVlOiAwLFxuICAgICAgdGV4dDogXCJoaWdoXCIsXG4gICAgfTtcbiAgfVxuICBzdGF0aWMgZ2V0IE1FRElVTSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY29sb3I6IFwiI0ZGQjMwMFwiLCAvL3llbGxvd2lzaFxuICAgICAgdmFsdWU6IDEsXG4gICAgICB0ZXh0OiBcIm1lZGl1bVwiLFxuICAgIH07XG4gIH1cbiAgc3RhdGljIGdldCBMT1coKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGNvbG9yOiBcIiM0M0EwNDdcIiwgLy9ncmVlbmlzaFxuICAgICAgdmFsdWU6IDIsXG4gICAgICB0ZXh0OiBcImxvd1wiLFxuICAgIH07XG4gIH1cbn1cblxuZXhwb3J0IHsgcHJpb3JpdHkgfTtcbiIsImltcG9ydCB7IHByaW9yaXR5IH0gZnJvbSBcIi4vcHJpb3JpdHlFbnVtXCI7XG5jb25zdCB0YXNrVUkgPSAoKCkgPT4ge1xuICBjb25zdCBjb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNvbnRlbnRcIilbMF07XG4gIGNvbnN0IGFkZFRvZG9Gb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b2RvLWZvcm1cIik7XG4gIGNvbnN0IHRvZG9TdWJtaXRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN1Ym1pdC10b2RvXCIpO1xuICBjb25zdCBmb3JtUHJpb3JpdHlFbGVtZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKFwicHJpb3JpdHlcIik7XG4gIGNvbnN0IGZvcm1UaXRsZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvZG8tdGl0bGVcIik7XG4gIGNvbnN0IGZvcm1EZXNjcmlwdGlvbkVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvZG8tZGVzY3JpcHRpb25cIik7XG4gIGNvbnN0IGZvcm1Qcm9qZWN0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9kby1mb3JtLXByb2plY3RzXCIpO1xuXG4gIGZ1bmN0aW9uIGNsb3NlVGFza0lucHV0Rm9ybSgpIHtcbiAgICBhZGRUb2RvRm9ybS5yZXNldCgpO1xuICAgIGNvbnN0IHRvZG9Nb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkLXRvZG8tbW9kYWxcIik7XG4gICAgdG9kb01vZGFsLmNsYXNzTGlzdC50b2dnbGUoXCJhZGQtdG9kby1tb2RhbC1vZmZcIik7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRUYXNrc0J5UHJvamVjdElkKHByb2plY3RJZCkge1xuICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGBkaXZbZGF0YS1wcm9qZWN0PVwiJHtwcm9qZWN0SWR9XCJdYCk7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRUYXNrQnlJZChpZCkge1xuICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgY2FyZC0ke2lkfWApO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0TmF2VGFza0J5SWQoaWQpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYG5hdlRhc2stJHtpZH1gKTtcbiAgfVxuXG4gIGNvbnN0IGNyZWF0ZVRhc2sgPSAoaWQsIHByb2plY3RJZCwgdGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlvcml0eUluKSA9PiB7XG4gICAgY29uc3QgY2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgY2FyZC5jbGFzc0xpc3QuYWRkKFwiY2FyZFwiKTtcbiAgICBjYXJkLmlkID0gYGNhcmQtJHtpZH1gO1xuICAgIGNhcmQuZGF0YXNldC5wcm9qZWN0ID0gcHJvamVjdElkOyAvL2l0IHdpbGwgd29yayBhcyBhIGZpbHRlclxuICAgIHtcbiAgICAgIGNvbnN0IGNhcmRIZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgY2FyZEhlYWRlci5jbGFzc0xpc3QuYWRkKFwiY2FyZC1oZWFkZXJcIik7XG5cbiAgICAgIHN3aXRjaCAocHJpb3JpdHlJbikge1xuICAgICAgICBjYXNlIHByaW9yaXR5LkxPVy50ZXh0OiB7XG4gICAgICAgICAgY2FyZEhlYWRlci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBwcmlvcml0eS5MT1cuY29sb3I7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBwcmlvcml0eS5NRURJVU0udGV4dDoge1xuICAgICAgICAgIGNhcmRIZWFkZXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gcHJpb3JpdHkuTUVESVVNLmNvbG9yO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgcHJpb3JpdHkuSElHSC50ZXh0OiB7XG4gICAgICAgICAgY2FyZEhlYWRlci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBwcmlvcml0eS5ISUdILmNvbG9yO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHtcbiAgICAgICAgY29uc3QgaDQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDRcIik7XG4gICAgICAgIGg0LnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgICAgIGNvbnN0IGRlbGV0ZVRhc2tCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgICBkZWxldGVUYXNrQnRuLmNsYXNzTGlzdC5hZGQoXCJidXR0b24yXCIpO1xuICAgICAgICBkZWxldGVUYXNrQnRuLnRleHRDb250ZW50ID0gXCItXCI7XG4gICAgICAgIGNhcmRIZWFkZXIuYXBwZW5kQ2hpbGQoaDQpO1xuICAgICAgICBjYXJkSGVhZGVyLmFwcGVuZENoaWxkKGRlbGV0ZVRhc2tCdG4pO1xuICAgICAgfVxuICAgICAgY29uc3QgY2FyZEJvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGV4dGFyZWFcIik7XG4gICAgICBjYXJkQm9keS5jbGFzc0xpc3QuYWRkKFwiY2FyZC1ib2R5XCIpO1xuICAgICAgY2FyZEJvZHkudmFsdWUgPSBkZXNjcmlwdGlvbjtcbiAgICAgIGNhcmQuYXBwZW5kQ2hpbGQoY2FyZEhlYWRlcik7XG4gICAgICBjYXJkLmFwcGVuZENoaWxkKGNhcmRCb2R5KTtcbiAgICB9XG4gICAgY29udGVudC5hcHBlbmRDaGlsZChjYXJkKTtcbiAgfTtcblxuICBjb25zdCBjcmVhdGVUYXNrTmF2QmFyID0gKGlkLCB0aXRsZSwgcHJpb3JpdHlJbikgPT4ge1xuICAgIGNvbnN0IHRhc2tFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB0YXNrRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFza1wiKTtcbiAgICB0YXNrRWxlbWVudC5pZCA9IGBuYXZUYXNrLSR7aWR9YDsgLy90YXNrLWlkXG4gICAge1xuICAgICAgY29uc3QgcHJpb3JpdHlJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIHByaW9yaXR5SWNvbi5jbGFzc0xpc3QuYWRkKFwicHJpb3JpdHktaWNvblwiKTtcbiAgICAgIHN3aXRjaCAocHJpb3JpdHlJbikge1xuICAgICAgICBjYXNlIHByaW9yaXR5LkxPVy50ZXh0OiB7XG4gICAgICAgICAgcHJpb3JpdHlJY29uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHByaW9yaXR5LkxPVy5jb2xvcjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlIHByaW9yaXR5Lk1FRElVTS50ZXh0OiB7XG4gICAgICAgICAgcHJpb3JpdHlJY29uLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHByaW9yaXR5Lk1FRElVTS5jb2xvcjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlIHByaW9yaXR5LkhJR0gudGV4dDoge1xuICAgICAgICAgIHByaW9yaXR5SWNvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBwcmlvcml0eS5ISUdILmNvbG9yO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb25zdCB0YXNrTmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICB0YXNrTmFtZS5jbGFzc0xpc3QuYWRkKFwidGFzay1uYW1lXCIpO1xuICAgICAgdGFza05hbWUudGV4dENvbnRlbnQgPSB0aXRsZTtcbiAgICAgIHRhc2tFbGVtZW50LmFwcGVuZENoaWxkKHByaW9yaXR5SWNvbik7XG4gICAgICB0YXNrRWxlbWVudC5hcHBlbmRDaGlsZCh0YXNrTmFtZSk7XG4gICAgfVxuICAgIHJldHVybiB0YXNrRWxlbWVudDtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGNyZWF0ZVRhc2tOYXZCYXIsXG4gICAgY3JlYXRlVGFzayxcbiAgICBmb3JtUHJpb3JpdHlFbGVtZW50cyxcbiAgICBhZGRUb2RvRm9ybSxcbiAgICB0b2RvU3VibWl0QnRuLFxuICAgIGZvcm1EZXNjcmlwdGlvbkVsZW1lbnQsXG4gICAgZm9ybVRpdGxlRWxlbWVudCxcbiAgICBmb3JtUHJvamVjdEVsZW1lbnQsXG4gICAgY2xvc2VUYXNrSW5wdXRGb3JtLFxuICAgIGNyZWF0ZVRhc2ssXG4gICAgZ2V0VGFza3NCeVByb2plY3RJZCxcbiAgICBjb250ZW50LFxuICAgIGdldE5hdlRhc2tCeUlkLFxuICB9O1xufSkoKTtcblxuZXhwb3J0IHsgdGFza1VJIH07XG4iLCJpbXBvcnQgeyBUb2RvIH0gZnJvbSBcIi4vVG9kb1wiO1xuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gXCIuL1Byb2plY3RcIjtcbmltcG9ydCB7IE1haW5BcHAgfSBmcm9tIFwiLi9NYWluQXBwXCI7XG5pbXBvcnQgeyBwcm9qZWN0VUkgfSBmcm9tIFwiLi9wcm9qZWN0VUlcIjtcbmltcG9ydCB7IHRhc2tVSSB9IGZyb20gXCIuL3Rhc2tVSVwiO1xuXG5jb25zdCBtcCA9IG5ldyBNYWluQXBwKCk7XG5jb25zdCB0b2dnbGVUYXNrQnV0dG9uSW1hZ2UgPSBcIi4vaW1hZ2VzL2ljb25zOC1leHBhbmQtYXJyb3ctMTYucG5nXCI7XG5cbmNvbnN0IGFwcENvbnRyb2xsZXIgPSAoKCkgPT4ge1xuICBjb25zdCBwcm9qZWN0ID0gKCgpID0+IHtcbiAgICBmdW5jdGlvbiBnZXROYW1lKCkge1xuICAgICAgcmV0dXJuIHByb2plY3RVSS5pbnB1dEVsZW1lbnQudmFsdWU7XG4gICAgfVxuICAgIGNvbnN0IGRlZmF1bHRQcm9qZWN0ID0gKCkgPT4ge1xuICAgICAgY29uc3QgZGVmYXVsdFByb2plY3QgPSBuZXcgUHJvamVjdChcImRlZmF1bHRcIik7XG4gICAgICBkZWZhdWx0UHJvamVjdC5faWQgPSAwO1xuICAgICAgbXAuYWRkUHJvamVjdChkZWZhdWx0UHJvamVjdCk7XG4gICAgICBwcm9qZWN0VUkuY3JlYXRlUHJvamVjdFVJKGRlZmF1bHRQcm9qZWN0Lm5hbWUsIGRlZmF1bHRQcm9qZWN0LmlkKTtcbiAgICAgIGNvbnN0IHByb2plY3RMaUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2plY3QtMFwiKTtcbiAgICAgIGNvbnN0IHByb2plY3RSb3cgPSBwcm9qZWN0TGlFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1yb3dcIik7XG4gICAgICBwcm9qZWN0Um93LmNsYXNzTGlzdC5yZW1vdmUoXCJwcm9qZWN0LXJvdy13aGl0ZXNwYWNlXCIpO1xuICAgIH07XG4gICAgZGVmYXVsdFByb2plY3QoKTtcbiAgICBmdW5jdGlvbiBhZGRQcm9qZWN0KG5hbWUpIHtcbiAgICAgIGxldCBwcm9qZWN0ID0gbmV3IFByb2plY3QobmFtZSk7XG4gICAgICBtcC5hZGRQcm9qZWN0KHByb2plY3QpO1xuICAgICAgcHJvamVjdFVJLmNyZWF0ZVByb2plY3RVSShwcm9qZWN0Lm5hbWUsIHByb2plY3QuaWQpO1xuICAgICAgcmV0dXJuIHByb2plY3QuaWQ7XG4gICAgfVxuICAgIHByb2plY3RVSS5hZGRQcm9qZWN0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBsZXQgbmFtZSA9IGdldE5hbWUoKTtcbiAgICAgIGxldCBpZCA9IGFkZFByb2plY3QobmFtZSk7XG4gICAgICBwcm9qZWN0VUkuY2xvc2VQcm9qZWN0SW5wdXROYW1lKCk7XG4gICAgICBwcm9qZWN0VUkuYWRkUHJvamVjdFRvVGFza0Zvcm0oaWQsIG5hbWUpO1xuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gZGVsZXRlUHJvamVjdChpZCkge1xuICAgICAgaWYgKGlkID09PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKG1wLnByb2plY3RMaXN0KTtcbiAgICAgIG1wLnJlbW92ZVByb2plY3QoaWQpO1xuICAgICAgcHJvamVjdFVJLnJlbW92ZVByb2plY3QoaWQpO1xuICAgICAgcHJvamVjdFVJLnJlbW92ZVByb2plY3RGcm9tVGFza0Zvcm0oaWQpO1xuICAgICAgbGV0IGFycmF5ID0gdGFza1VJLmdldFRhc2tzQnlQcm9qZWN0SWQoaWQpO1xuICAgICAgYXJyYXkuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgICBlbGVtZW50LnJlbW92ZSgpO1xuICAgICAgfSk7XG4gICAgICBjb25zb2xlLmxvZyhtcC5wcm9qZWN0TGlzdCk7XG4gICAgfVxuXG4gICAgcHJvamVjdFVJLnByb2plY3RXcmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgaWYgKGUudGFyZ2V0LmRhdGFzZXQuaWQgPT09IFwicmVtb3ZlLXByb2plY3RcIikge1xuICAgICAgICBjb25zdCBwcm9qZWN0SGVhZGVyID0gZS50YXJnZXQucGFyZW50Tm9kZTtcbiAgICAgICAgY29uc3QgcHJvamVjdFJvdyA9IHByb2plY3RIZWFkZXIucGFyZW50Tm9kZTtcbiAgICAgICAgY29uc3QgbGkgPSBwcm9qZWN0Um93LnBhcmVudE5vZGU7XG4gICAgICAgIGNvbnN0IGlkID0gbGkuaWQuc3BsaXQoXCItXCIpWzFdO1xuICAgICAgICBkZWxldGVQcm9qZWN0KHBhcnNlSW50KGlkKSk7XG4gICAgICAgIC8vbW9yZSBjbGVhbiB3YXkgd291bGQgYmUgaGF2aW5nIHRoZSBzYW1lIGlkIG51bWJlciBpbiBkYXRhLWlkIGFzIHRoZSBsaSBpZFxuICAgICAgfVxuICAgIH0pO1xuICB9KSgpO1xuXG4gIGNvbnN0IHRhc2tzID0gKCgpID0+IHtcbiAgICBmdW5jdGlvbiBhZGRUYXNrKHByb2plY3RJZCwgdGFza05hbWUsIHRhc2tEZXNjciwgdGFza1ByaW8pIHtcbiAgICAgIGxldCB0YXNrID0gbmV3IFRvZG8odGFza05hbWUsIHRhc2tEZXNjciwgdGFza1ByaW8sIHByb2plY3RJZCk7XG4gICAgICBjb25zb2xlLnRhYmxlKG1wLnByb2plY3RMaXN0KTtcbiAgICAgIGxldCBhcnJheSA9IG1wLnByb2plY3RMaXN0O1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoYXJyYXlbaV0uaWQgPT09IHByb2plY3RJZCkge1xuICAgICAgICAgIGFycmF5W2ldLmFkZFRvZG8odGFzayk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIFRvRG8odGFzayk7IC8vcmVmZXJlbmNlIHRvIG9iamVjdCBpbnNpZGUgdGhlIGFycmF5XG4gICAgICBjb25zdCB0YXNrRE9NTmF2RWxlbWVudCA9IHRhc2tVSS5jcmVhdGVUYXNrTmF2QmFyKFxuICAgICAgICB0YXNrLmlkLFxuICAgICAgICB0YXNrLnRpdGxlLFxuICAgICAgICB0YXNrLnByaW9yaXR5XG4gICAgICApO1xuICAgICAgY29uc3QgdGFza1dyYXBwZXIgPSBwcm9qZWN0VUkuZ2V0VGFza1dyYXBwZXIocHJvamVjdElkKTtcbiAgICAgIHRhc2tXcmFwcGVyLmFwcGVuZENoaWxkKHRhc2tET01OYXZFbGVtZW50KTtcbiAgICAgIHRhc2tVSS5jcmVhdGVUYXNrKFxuICAgICAgICB0YXNrLmlkLFxuICAgICAgICBwcm9qZWN0SWQsXG4gICAgICAgIHRhc2sudGl0bGUsXG4gICAgICAgIHRhc2suZGVzY3JpcHRpb24sXG4gICAgICAgIHRhc2sucHJpb3JpdHlcbiAgICAgICk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0VGl0bGUoKSB7XG4gICAgICByZXR1cm4gdGFza1VJLmZvcm1UaXRsZUVsZW1lbnQudmFsdWU7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldERlc2NyKCkge1xuICAgICAgcmV0dXJuIHRhc2tVSS5mb3JtRGVzY3JpcHRpb25FbGVtZW50LnZhbHVlO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnZXRQcmlvKCkge1xuICAgICAgbGV0IGVsZW1lbnRzID0gdGFza1VJLmZvcm1Qcmlvcml0eUVsZW1lbnRzO1xuICAgICAgbGV0IGNoZWNrZWRWYWx1ZTtcbiAgICAgIGVsZW1lbnRzLmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgICAgaWYgKGVsZW1lbnQuY2hlY2tlZCkge1xuICAgICAgICAgIGNoZWNrZWRWYWx1ZSA9IGVsZW1lbnQudmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGNoZWNrZWRWYWx1ZTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0UHJvamVjdElkKCkge1xuICAgICAgbGV0IGVsZW1lbnQgPSB0YXNrVUkuZm9ybVByb2plY3RFbGVtZW50O1xuICAgICAgcmV0dXJuIHBhcnNlSW50KGVsZW1lbnQudmFsdWUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZUNhcmQoZSkge1xuICAgICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImJ1dHRvbjJcIikpIHtcbiAgICAgICAgbGV0IGNhcmQgPSBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGU7XG4gICAgICAgIGxldCBjYXJkSWQgPSBjYXJkLmlkOyAvLydjYXJkLSR7aWR9J1xuICAgICAgICBsZXQgcHJvamVjdElkID0gcGFyc2VJbnQoY2FyZC5kYXRhc2V0LnByb2plY3QpO1xuICAgICAgICAvL2UudGFyZ2V0LnBhcmVudE5vZGUsIGlzIG9uIHRoZSBjb250ZW50LCB3ZSBuZWVkIHRvIGRlbGV0ZSB0aGUgdGFzayBmcm9tIHRoZSBuYXZiYXIgYWxzbywgYW5kIHVwZGF0ZSB0aGUgdG9kbyBsaXN0XG4gICAgICAgIGxldCB0YXNrSWQgPSBwYXJzZUludChjYXJkSWQuc3BsaXQoXCItXCIpWzFdKTtcbiAgICAgICAgY2FyZC5yZW1vdmUoKTsgLy9kZWxldGUgdGFzayBmcm9tIGNvbnRlbnRcbiAgICAgICAgdGFza1VJLmdldE5hdlRhc2tCeUlkKHRhc2tJZCkucmVtb3ZlKCk7IC8vZGVsZXRlIHRhc2sgZnJvbSBzaWRlbmF2XG4gICAgICAgIGxldCBwcm9qZWN0T2ZUYXNrID0gbXAuZ2V0UHJvamVjdChwcm9qZWN0SWQpO1xuICAgICAgICBjb25zb2xlLmxvZyhwcm9qZWN0T2ZUYXNrLl90b2RvTGlzdCk7XG4gICAgICAgIHByb2plY3RPZlRhc2suZGVsZXRlVG9kbyh0YXNrSWQpOyAvL2RlbGV0ZSB0YXNrIGZyb20gcHJvamVjdCB0b2RvIGxpc3RcbiAgICAgICAgY29uc29sZS5sb2cocHJvamVjdE9mVGFzay5fdG9kb0xpc3QpO1xuICAgICAgfVxuICAgIH1cbiAgICB0YXNrVUkuY29udGVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgcmVtb3ZlQ2FyZCk7XG4gICAgdGFza1VJLmNvbnRlbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCAoZSkgPT4ge1xuICAgICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImNhcmQtYm9keVwiKSkge1xuICAgICAgICBsZXQgY2FyZEJvZHkgPSBlLnRhcmdldDtcbiAgICAgICAgbGV0IGNhcmQgPSBlLnRhcmdldC5wYXJlbnROb2RlO1xuICAgICAgICBsZXQgY2FyZElkID0gY2FyZC5pZDtcbiAgICAgICAgbGV0IHRhc2tJZCA9IHBhcnNlSW50KGNhcmRJZC5zcGxpdChcIi1cIilbMV0pO1xuICAgICAgICBsZXQgcHJvamVjdElkID0gcGFyc2VJbnQoY2FyZC5kYXRhc2V0LnByb2plY3QpO1xuICAgICAgICAvL3dlIG5lZWQgdG8gc2F2ZSB0aGUgdGV4dCBmcm9tIGNhcmRib2R5IHRvIHRoZSB0b2RvIGRlc2NyaXB0aW9uXG4gICAgICAgIGxldCB0b2RvRWxlbWVudCA9IG1wXG4gICAgICAgICAgLmdldFByb2plY3QocHJvamVjdElkKVxuICAgICAgICAgIC50b2RvTGlzdC5maW5kKCh0b2RvKSA9PiB0b2RvLmlkID09PSB0YXNrSWQpO1xuICAgICAgICB0b2RvRWxlbWVudC5kZXNjcmlwdGlvbiA9IGNhcmRCb2R5LnZhbHVlO1xuICAgICAgICBjb25zb2xlLmxvZyhtcC5nZXRQcm9qZWN0KHByb2plY3RJZCkudG9kb0xpc3QpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGFza1VJLmFkZFRvZG9Gb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGFkZFRhc2soZ2V0UHJvamVjdElkKCksIGdldFRpdGxlKCksIGdldERlc2NyKCksIGdldFByaW8oKSk7XG4gICAgICB0YXNrVUkuY2xvc2VUYXNrSW5wdXRGb3JtKCk7XG4gICAgfSk7XG4gIH0pKCk7XG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==